<?xml version="1.0" encoding="utf-8"?>
<!--
////////////////////////////////////////////////////////////////////////////////
//
//     Copyright (C) 2008 Bruno Garnier <bruno.garnier@gmail.com>
//
//     This program is free software: you can redistribute it and/or modify
//     it under the terms of the GNU General Public License as published by
//     the Free Software Foundation, either version 3 of the License, or
//     (at your option) any later version.
//
//     This program is distributed in the hope that it will be useful,
//     but WITHOUT ANY WARRANTY; without even the implied warranty of
//     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
//     GNU General Public License for more details.
//
//     You should have received a copy of the GNU General Public License
//     along with this program.  If not, see <http://www.gnu.org/licenses/>.
//
////////////////////////////////////////////////////////////////////////////////
-->

<mx:Canvas xmlns:mx="http://www.adobe.com/2006/mxml" 
	width="115" height="160" 
	creationComplete="_init();"
	horizontalCenter="true"
	>

	<mx:Script>
	  <![CDATA[
	  
	  	import mx.controls.Alert;
	  	import aspoker.com.bubsy.poker.client.model.Player;
	  	import aspoker.com.bubsy.poker.client.model.Table;
 		import aspoker.com.bubsy.poker.client.PokerClient;
 		import aspoker.com.bubsy.poker.client.model.User;
 		import aspoker.com.bubsy.poker.client.event.TableEvent;
 		import mx.core.Application;
 	
 		public static const IMAGE_PATH:String = "http://www.aspoker.info/beta/assets/cards/small-";
    		
 		private var _gameId:int=0;
 		private var _seatId:int=0;
		private var _table:Table;
		
		public function set table(table:Table):void
 		{
 			_table=table;
		}
		
 		public function set gameId(gameId:int):void
 		{
 			_gameId= gameId;
		}
 		
 		public function set seatId(seatId:int):void
 		{
 			_seatId = seatId;
 		}
 		
 		public function get seatId():int
 		{
 			return _seatId;
 		}
 		
 			
 		private function _init():void
 		{
 			this.currentState = "free";
 			seatname.text = "seat: " + _seatId;
 		}
		
		private function setPlayerName():String
 		{
 			return _table.getPlayerFromSeat(_seatId).name;
 		}
 		
 	    public function setCards(boardCards:Array/*of cards*/):void
		{
			card0.source = IMAGE_PATH + boardCards[0].name + ".png";
			card0.visible = true;
			card1.source = IMAGE_PATH + boardCards[1].name + ".png";
			card1.visible = true;
		}
    		
 		public function setPlayerChips():void
 		{
 			var chips:TextArea =  seats.getChildByName("chips") as TextArea;
 			chips.text = "" + _table.getPlayerFromSeat(_seatId).money as String;
 		}
 	 ]]>
 	</mx:Script>
 	
 	<mx:VBox id="seats" name="seats" 
		horizontalAlign="center"
 		verticalAlign="bottom"
 		width="100%" height="100%" 
 		>
 	
 		<mx:HBox name="cards" id="cards">
			<mx:Image id="card0" 
				name="card3" 
				autoLoad="true" 
				source="http://www.aspoker.info/beta/assets/cards/small-back.png"
				visible="false"
			/> 

		<mx:Image id="card1" 
				name="card4" 
				autoLoad="true" 
				source="http://www.aspoker.info/beta/assets/cards/small-back.png"
				visible="false"
			/> 		 	
		</mx:HBox>
 	</mx:VBox>
	 		
 	<mx:states>
 		 <mx:State name="free">
 		 	<mx:AddChild relativeTo="{seats}">
		 			<mx:Label id="seatname" 
		 				text="" />
		 	</mx:AddChild>
		 	
		 	<mx:AddChild relativeTo="{seats}">	
	  			<mx:TextArea id="seatbutton" 
	  				textAlign="center"
	  				borderStyle="solide"
	  				backgroundAlpha="0.8"
	  				dropShadowEnabled="true"
	  				selectable="false"
	  				editable="false"
	  				width="100"
	  				text="Click here to get a seat"
					cornerRadius="5"
	  				fontWeight="bold" 
	  				click="_table.seat(_seatId);" /> 		
 			</mx:AddChild>
	 	</mx:State>
	 	
	 	<mx:State name="sitin" basedOn="arrive">
	 		<mx:SetProperty target="{playerName}" name="enabled" value="true"/>
	 		<mx:SetProperty target="{playerState}" name="text" value="Sit-in"/>
	 		<mx:SetProperty target="{playerState}" name="enabled" value="true"/>
	 		<mx:SetProperty target="{chips}" name="enabled" value="true"/>
	 		<mx:SetProperty target="{amount}" name="enabled" value="true"/>
	 			 		
	 		<mx:SetProperty target="{card0}" name="visible" value="false"/>
	 		<mx:SetProperty target="{card1}" name="visible" value="false"/>
	 		
	 	</mx:State>
	 	
	 	
	 	<mx:State name="inposition" basedOn="arrive">
		 	<mx:SetProperty target="{playerName}" name="enabled" value="true"/>
		 	<mx:SetProperty target="{playerState}" name="enabled" value="true"/>
	 		<mx:SetProperty target="{chips}" name="enabled" value="true"/>
	 		<mx:SetProperty target="{amount}" name="enabled" value="true"/>
	 		
			<mx:SetStyle target="{seats}" name="borderStyle" value="solide"/>
			<mx:SetStyle target="{seats}" name="borderThickness" value="7"/>

	 		<mx:SetStyle target="{seats}" name="borderColor" value="green"/>
	 		<mx:SetProperty target="{playerState}" name="text" value=""/>
	 	</mx:State>
	 	
	 	<mx:State name="wait" basedOn="arrive">
		 	<mx:SetProperty target="{playerName}" name="enabled" value="true"/>
		 	<mx:SetProperty target="{playerState}" name="enabled" value="true"/>
	 		<mx:SetProperty target="{chips}" name="enabled" value="true"/>
	 		<mx:SetProperty target="{amount}" name="enabled" value="true"/>	 		
	 		<mx:SetStyle target="{seats}" name="borderColor" value="red"/> 		
	 	</mx:State>
		
		<mx:State name="clear" basedOn="arrive">
		 	<mx:SetProperty target="{playerName}" name="enabled" value="true"/>
		 	<mx:SetProperty target="{playerState}" name="enabled" value="true"/>
	 		<mx:SetProperty target="{chips}" name="enabled" value="true"/>
	 		<mx:SetProperty target="{amount}" name="enabled" value="true"/>
	 			 		
			<mx:SetProperty target="{playerState}" name="text" value=""/>	 			 		
			<mx:SetProperty target="{amount}" name="text" value=""/>
	 		<mx:SetStyle target="{seats}" name="borderColor" value="red"/>
	 	</mx:State>
	 		 		 		
	 	<mx:State name="sitout" basedOn="arrive">
	 		<mx:SetProperty target="{playerName}" name="enabled" value="false"/>
	 		<mx:SetProperty target="{playerState}" name="text" value="Sit-out"/>
	 		<mx:SetProperty target="{playerState}" name="enabled" value="false"/>
	 		<mx:SetProperty target="{chips}" name="enabled" value="false"/>
	 		<mx:SetProperty target="{amount}" name="enabled" value="false"/>
	 		
	 		<mx:SetProperty target="{card0}" name="visible" value="false"/>
	 		<mx:SetProperty target="{card1}" name="visible" value="false"/>
	 		
	 	</mx:State>
	 	
		<mx:State name="arrive" id="arrive">
		 	<mx:AddChild relativeTo="{seats}" >
		 		<mx:TextArea name="playerName" 
		 			id="playerName" 
		 			text="{setPlayerName()}" 
	  				selectable="false"
	  				editable="false"
	  				enabled="false"
		 			width="100"
		 			height="20"
		 			cornerRadius="5"
		 			color="green"
  					dropShadowEnabled="true"
	  				fontWeight="bold" 
		 			textAlign="center"
  					backgroundAlpha="0.8"/>			
 		  	</mx:AddChild>			
 		  	
 		  	<mx:AddChild relativeTo="{seats}" >
		 		<mx:TextArea name="chips" 
		 			id="chips"
		 			text="0" 
					selectable="false"
					enabled="false"
	  				editable="false"
		 			width="100"
		 			height="20"
		 			color="green"
		 			cornerRadius="5"
  					dropShadowEnabled="true"
	  				fontWeight="bold" 
		 			textAlign="center"
  					backgroundAlpha="0.8"/>
			</mx:AddChild>
			
			<mx:AddChild relativeTo="{seats}" >
		 		<mx:TextArea name="playerState" 
		 			id="playerState" 
		 			enabled="false"
		 			selectable="false"
		 			editable="false"
	  				width="100"
		 			height="20"
		 			color="green"
		 			cornerRadius="5"
  					dropShadowEnabled="true"
	  				fontWeight="bold" 
		 			textAlign="center"
  					backgroundAlpha="0.8"/>
			</mx:AddChild>
			
			<mx:AddChild relativeTo="{seats}" >
		 		<mx:TextArea name="amount" 
		 			id="amount" 
		 			enabled="false"
		 			selectable="false"
		 			editable="false"
	  				width="100"
		 			height="20"
		 			color="green"
		 			cornerRadius="5"
  					dropShadowEnabled="true"
	  				fontWeight="bold" 
		 			textAlign="center"
  					backgroundAlpha="0.8"/>
			</mx:AddChild>
			
			
	 	</mx:State>
	 	
		<mx:State name="disabled" basedOn="">

	 	</mx:State>
	</mx:states>   	
</mx:Canvas>

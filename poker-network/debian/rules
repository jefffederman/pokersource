#!/usr/bin/make -f
# -*- makefile -*-

DEB_AUTO_PACKAGES = $(filter python2., $(DEB_ALL_PACKAGES))

include debian/rules.mk

DEB_BUILDDIR_python2.3-poker2d := python2.3-build
DEB_BUILDDIR_python2.3-poker-network := python2.3-build
DEB_BUILDDIR_python2.4-poker2d := python2.4-build
DEB_BUILDDIR_python2.4-poker-network := python2.4-build

DEB_CONFIGURE_EXTRA_FLAGS += \
		--with-poker-server-host=%HOST% \
		--with-poker-database=%DATABASE% \
		--with-poker-dbhost=%DBHOST% \
		--with-poker-dbuser=%USER% \
		--with-poker-dbuser-password=%PASS%

install/python2.3-poker-network install/python2.4-poker-network :: 
	for man in pokerdatabaseupgrade pokerbot pokerserver ; do \
		cp -a $(DEB_DESTDIR)/usr/share/man/man8/$$man.8 $(DEB_DESTDIR)/usr/share/man/man8/$$man$(python_version).8 ; \
	done

install/python2.3-poker2d install/python2.4-poker2d ::
	for man in poker2d ; do \
		cp -a $(DEB_DESTDIR)/usr/share/man/man6/$$man.6 $(DEB_DESTDIR)/usr/share/man/man6/$$man$(python_version).6 ; \
	done

common-configure-arch common-configure-indep:: $(DEB_SRCDIR)/config.status

install/poker-web ::
	ln -fs /etc/poker-web/htaccess pokerweb/pages/.htaccess
	ln -fs /etc/poker-web/constants.php pokerweb/pages/constants.php
	mkdir -p debian/poker-web/var/www
	ln -fs /usr/share/poker-web debian/poker-web/var/www/poker-web
